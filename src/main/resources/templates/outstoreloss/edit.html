<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:replace="head::head(${title})">
</head>
<link th:href="@{/assets/css/select/bootstrap-select.min.css}" rel="stylesheet" media="screen">
<script th:src="@{/assets/js/select/bootstrap-select.js}"></script>
<script th:src="@{/assets/js/select/defaults-zh_CN.js}"></script>
<link th:href="@{/assets/js/uploadify/uploadify.css}" rel="stylesheet" type="text/css">
<script th:src="@{/assets/js/uploadify/jquery.uploadify.js}"></script>


<body style="overflow-x: hidden">
<form class="form-horizontal" role="form" id="validation-form" method="get">
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="billcode">
            单号:
        </label>
        <div class="col-sm-4">
            <input type="text" name="billcode" id="billcode" class="form-control"
                   th:value="${item.billcode}" readonly
                   placeholder="单号"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="storageid">
            <span class="red">*</span>仓房:
        </label>
        <div class="col-sm-4">
            <select id="storageid" name="storageid" class="form-control"
                    data-bv-notempty th:value="${item.storageid}">
            </select>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="grainid">
            <span class="red">*</span>粮食品种:
        </label>
        <div class="col-sm-4">
            <select id="grainid" name="grainid" class="form-control"
                    data-bv-notempty th:value="${item.grainid}">
            </select>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="grainattrid">
            粮食性质:
        </label>
        <div class="col-sm-4">
            <select id="grainattrid" name="grainattrid" class="form-control"
                    th:value="${item.grainattrid}">
            </select>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="producingyear">
            收获年度:
        </label>
        <div class="col-sm-4">
            <input type="text" name="producingyear" id="producingyear"
                   class="form_year form-control"
                   th:value="${item.producingyear}" readonly
                   placeholder="收获年度"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="instordatestr">
            入仓日期:
        </label>
        <div class="col-sm-4">
            <input size="16" type="text" name="instordatestr" id="instordatestr"
                   th:value="${item.instordatestr}"
                   readonly class="form_date form-control"></div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="outstordatestr">
            出仓日期:
        </label>
        <div class="col-sm-4">
            <input size="16" type="text" name="outstordatestr" id="outstordatestr"
                   th:value="${item.outstordatestr}"
                   readonly class="form_date form-control"></div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="keepmonth">
            保管月数:
        </label>
        <div class="col-sm-4">
            <input type="text" name="keepmonth" id="keepmonth" class="form-control"
                   th:value="${item.keepmonth}"
                   placeholder="保管月数"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="isqty">
            入库数量:
        </label>
        <div class="col-sm-4">
            <input type="text" name="isqty" id="isqty" class="form-control"
                   th:value="${item.isqty}"
                   placeholder="入库数量"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="iswaterrate">
            入库水分率:
        </label>
        <div class="col-sm-4">
            <input type="text" name="iswaterrate" id="iswaterrate" class="form-control"
                   th:value="${item.iswaterrate}"
                   placeholder="入库水分率"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="oswaterrate">
            出库水分率:
        </label>
        <div class="col-sm-4">
            <input type="text" name="oswaterrate" id="oswaterrate" class="form-control"
                   th:value="${item.oswaterrate}"
                   placeholder="出库水分率"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="waterlossqty">
            水分减量:
        </label>
        <div class="col-sm-4">
            <input type="text" name="waterlossqty" id="waterlossqty" class="form-control"
                   th:value="${item.waterlossqty}"
                   placeholder="水分减量"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="isimpurate">
            入库杂质率:
        </label>
        <div class="col-sm-4">
            <input type="text" name="isimpurate" id="isimpurate" class="form-control"
                   th:value="${item.isimpurate}"
                   placeholder="入库杂质率"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="osimpurate">
            出库杂质率:
        </label>
        <div class="col-sm-4">
            <input type="text" name="osimpurate" id="osimpurate" class="form-control"
                   th:value="${item.osimpurate}"
                   placeholder="出库杂质率"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="impulossqty">
            杂质减量:
        </label>
        <div class="col-sm-4">
            <input type="text" name="impulossqty" id="impulossqty" class="form-control"
                   th:value="${item.impulossqty}"
                   placeholder="杂质减量"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="osqty">
            出库数量:
        </label>
        <div class="col-sm-4">
            <input type="text" name="osqty" id="osqty" class="form-control"
                   th:value="${item.osqty}"
                   placeholder="出库数量"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="keeplossqty">
            保管自然损耗量:
        </label>
        <div class="col-sm-4">
            <input type="text" name="keeplossqty" id="keeplossqty" class="form-control"
                   th:value="${item.keeplossqty}"
                   placeholder="保管自然损耗量"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="keeplossrate">
            保管自然损耗率:
        </label>
        <div class="col-sm-4">
            <input type="text" name="keeplossrate" id="keeplossrate" class="form-control"
                   th:value="${item.keeplossrate}"
                   placeholder="保管自然损耗率"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="rationlossrate">
            定额耗比率:
        </label>
        <div class="col-sm-4">
            <input type="text" name="rationlossrate" id="rationlossrate" class="form-control"
                   th:value="${item.rationlossrate}"
                   placeholder="定额耗比率"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="rationlossqty">
            定额耗数量:
        </label>
        <div class="col-sm-4">
            <input type="text" name="rationlossqty" id="rationlossqty" class="form-control"
                   th:value="${item.rationlossqty}"
                   placeholder="定额耗数量"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="orlossqty">
            超定额损耗数量:
        </label>
        <div class="col-sm-4">
            <input type="text" name="orlossqty" id="orlossqty" class="form-control"
                   th:value="${item.orlossqty}"
                   placeholder="超定额损耗数量"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="profitqty">
            溢余数量:
        </label>
        <div class="col-sm-4">
            <input type="text" name="profitqty" id="profitqty" class="form-control"
                   th:value="${item.profitqty}"
                   placeholder="溢余数量"/>
        </div>
    </div>
    <!--<div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="passstate">
            上级审批状态（0：预报，1：已报）:
        </label>
        <div class="col-sm-4">
            <select id="passstate" name="passstate" class="form-control"
                    th:value="${item.passstate}">
            </select>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="preupdatestr">
            预报日期:
        </label>
        <div class="col-sm-4">
            <input size="16" type="text" name="preupdatestr" id="preupdatestr"
                   th:value="${item.preupdatestr}"
                   readonly class="form_date form-control"></div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="updatestr">
            已报日期:
        </label>
        <div class="col-sm-4">
            <input size="16" type="text" name="updatestr" id="updatestr"
                   th:value="${item.updatestr}"
                   readonly class="form_date form-control"></div>
    </div>
    -->
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="outplanid">
            出库计划安排:
        </label>
        <div class="col-sm-4">
            <select id="outplanid" name="outplanid" class="form-control"
                    data-bv-notempty th:value="${item.outplanid}">
            </select>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-4 control-label no-padding-right" for="remark">
            备注:
        </label>
        <div class="col-sm-4">
            <input type="text" name="remark" id="remark" class="form-control"
                   th:value="${item.remark}"
                   placeholder="备注"/>
        </div>
    </div>

    <div class="form-group">
        <div class="col-md-6 center">
            <button class="btn btn-info" type="submit">
                <i class="icon-ok bigger-110"></i>
                保存
            </button>
            &nbsp; &nbsp; &nbsp;
            <button class="btn" type="button" onclick="toBack()">
                <i class="icon-arrow-left bigger-110"></i>
                返回
            </button>
        </div>
    </div>

</form>

</body>
</html>
<script th:inline="javascript">
    var urlPrefix="/graindepot-bussiness";
    //var urlPrefix = "";
    var g_id = [[${id}]];
    var g_item = [[${item}]];
    var param={};
    $(function () {
        //初始化时间框
        $(".form_date").bootstrapDate();
        $(".form_year").bootstrapYear();

        $("#keepmonth").bootstrapNumber();
        $("#isqty").bootstrapNumber({precision:2});
        $("#iswaterrate").bootstrapNumber({precision:2});
        $("#oswaterrate").bootstrapNumber({precision:2});
        $("#waterlossqty").bootstrapNumber({precision:2});
        $("#isimpurate").bootstrapNumber({precision:2});
        $("#osimpurate").bootstrapNumber({precision:2});
        $("#impulossqty").bootstrapNumber({precision:2});
        $("#osqty").bootstrapNumber({precision:2});
        $("#keeplossqty").bootstrapNumber({precision:2});
        $("#keeplossrate").bootstrapNumber({precision:2});
        $("#rationlossrate").bootstrapNumber({precision:2});
        $("#rationlossqty").bootstrapNumber({precision:2});
        $("#orlossqty").bootstrapNumber({precision:2});
        $("#profitqty").bootstrapNumber({precision:2});
        //初始化form验证
        initForm();
        //初始化下拉框
        initStorage();
        initGrain();
        initGrainattr();
        initOutplan();
    });

    function initStorage() {
        $("#storageid").bootstrapSelect({
            url: '/graindepot-base/selector/storageList',
            type: 'GET',
            valueField: 'storageid',
            textField: 'storagename'
        })
    }

    function initGrain() {
        $("#grainid").bootstrapSelect({
            url: '/graindepot-base/selector/grainList',
            type: 'GET',
            valueField: 'grainid',
            textField: 'grainname'
        });
    }
    function initGrainattr() {
        $("#grainattrid").bootstrapSelect({
            url: '/graindepot-base/selector/grainattrList',
            type: 'GET',
            valueField: 'grainattrid',
            textField: 'grainattrname'
        });
    }

    function initOutplan() {
        $("#outplanid").bootstrapSelect({
            url: '/graindepot-base/selector/outplanList',
            type: 'GET',
            valueField: 'outplanid',
            textField: 'planname'
        });
    }


    function toBack() {
        parent.$.bootstrapBox.dialog.close();
    }

    function initForm() {
        $('#validation-form').bootstrapValidator().on('success.form.bv', function (e) {
            // 组织表单提交改为ajax提交
            e.preventDefault();
            var param = turnArrayToJson($('form').serializeArray());
            if (g_id) {
                param.billid = g_id
            }
            $.post(urlPrefix + "/outstoreloss/edit", param, function (result) {
                parent.toSave(result)
            })
        });
    }


</script>