<!DOCTYPE html><html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"><head th:replace="head::head(${title})"></head><link th:href="@{/assets/css/select/bootstrap-select.min.css}" rel="stylesheet" media="screen"><script th:src="@{/assets/js/select/bootstrap-select.js}"></script><script th:src="@{/assets/js/select/defaults-zh_CN.js}"></script><link th:href="@{/assets/js/uploadify/uploadify.css}" rel="stylesheet" type="text/css"><script th:src="@{/assets/js/uploadify/jquery.uploadify.js}"></script><body style="overflow-x: hidden"><form class="form-horizontal" role="form" id="validation-form" method="get">    <div class="form-group">        <label class="col-sm-4 control-label no-padding-right" for="goodsname">            物料/资料名称:        </label> <div class="col-sm-4">        <input type="text" name="goodsname" id="goodsname" class="form-control"               th:value="${item.goodsname}"               placeholder="物料/资料名称"/>    </div>    </div>    <div class="form-group">    <label class="col-sm-4 control-label no-padding-right" for="goodstypeid"> 物料/资料类型 </label>    <div class="col-sm-4">    <select id="goodstypeid" name="goodstypeid" class="form-control" th:value="${item.goodstypeid}">    </select>    </div>    </div>    <div class="form-group">        <label class="col-sm-4 control-label no-padding-right" for="goodscode">            物料/资料编码:        </label> <div class="col-sm-4">        <input type="text" name="goodscode" id="goodscode" class="form-control"               th:value="${item.goodscode}"               placeholder="物料/资料编码"/>    </div>    </div>    <div class="form-group">        <label class="col-sm-4 control-label no-padding-right" for="goodsspec">            规格:        </label> <div class="col-sm-4">        <input type="text" name="goodsspec" id="goodsspec" class="form-control"               th:value="${item.goodsspec}"               placeholder="规格"/>    </div>    </div>    <div class="form-group">        <label class="col-sm-4 control-label no-padding-right" for="measunit">            计量单位:        </label> <div class="col-sm-4">        <input type="text" name="measunit" id="measunit" class="form-control"               th:value="${item.measunit}"               placeholder="计量单位"/>    </div>    </div>    <div class="form-group">        <label class="col-sm-4 control-label no-padding-right" for="barcode">            条码:        </label> <div class="col-sm-4">        <input type="text" name="barcode" id="barcode" class="form-control"               th:value="${item.barcode}"               placeholder="条码"/>    </div>    </div>    <div class="form-group">        <label class="col-sm-4 control-label no-padding-right" for="description">            描述:        </label> <div class="col-sm-4">        <input type="text" name="description" id="description" class="form-control"               th:value="${item.description}"               placeholder="描述"/>    </div>    </div>    <div class="form-group">        <label class="col-sm-4 control-label no-padding-right" for="remark">            备注:        </label> <div class="col-sm-4">        <input type="text" name="remark" id="remark" class="form-control"               th:value="${item.remark}"               placeholder="备注"/>    </div>    </div>    <div class="form-group">        <label class="col-sm-4 control-label no-padding-right" for="sequno">            排序号:        </label> <div class="col-sm-4">        <input type="text" name="sequno" id="sequno" class="form-control"               th:value="${item.sequno}"               placeholder="排序号"/>    </div>    </div>    <div class="form-group">        <div class="col-md-12 center">            <button class="btn btn-info" type="submit">                <i class="icon-ok bigger-110"></i>                保存            </button>            &nbsp; &nbsp; &nbsp;            <button class="btn" type="button" onclick="toBack()">                <i class="icon-arrow-left bigger-110"></i>                返回            </button>        </div>    </div></form></body></html><script th:inline="javascript">    var urlPrefix="/graindepot-bussiness";    //var urlPrefix = "";    var g_id = [[${id}]];    var g_item = [[${item}]];    $(function () {        //初始化form验证        initForm();        //初始化日期时间框        // $(".form_year").bootstrapYear();        //$(".form_datetime").bootstrapDatetime();        // $(".form_date").bootstrapDate();        //初始化下拉框        //1.初始化物料类型        initGoodsTypeID();        //2.初始化集团.企业和库点;        // initGroupAndCopAndGd();        //初始化上传头像按钮        // $("#fileNameList").bootstrapUploadify({        //     showId: "showFileNameList"//上传成功后在那边显示信息        //     //fileType: "img"//需要上传的文件类型        // });    });    //查询全部物料类型记录    function initGoodsTypeID() {        $("#goodstypeid").bootstrapSelect({            url: '/graindepot-bussiness/selector/goodstypeList',            type: 'GET',            valueField: 'goodstypeid',            textField: 'goodstypename',            defaultValue: g_item.goodstypeid        })    }    //根据集团查询公司和粮仓    function initGroupAndCopAndGd() {        $("#groupid").bootstrapSelect({            url:  '/graindepot-base/selector/groupList',            type: 'GET',            valueField: 'groupid',            textField: 'groupname',            defaultValue: g_item.groupid,            onSelect: function (value) {                $("#companyid").bootstrapSelect({                    url: '/graindepot-base/selector/companyList',                    type: 'GET',                    param: {groupid: value},                    valueField: 'companyid',                    textField: 'companyname',                    defaultValue: g_item.companyid,                    onSelect: function (value) {                        $("#graindepotid").bootstrapSelect({                            url: '/graindepot-base/selector/graindepotList',                            type: 'GET',                            param: {companyid: value},                            valueField: 'graindepotid',                            textField: 'graindepotname',                            defaultValue: g_item.graindepotid                        });                    }                });            }        });    }    function toBack() {        parent.$.bootstrapBox.dialog.close();    }    //填写表单    function initForm() {        $('#validation-form').bootstrapValidator({            fields: {                goodstypename: {                    validators: {                        remote: {                            url: urlPrefix + '/goods/checkRepeat',                            message: '物料名称已存在',//提示消息                            //delay :  2000,//每输入一个字符，就发ajax请求，服务器压力还是太大，设置2秒发送一次ajax（默认输入一个字符，提交一次，服务器压力太大）                            type: 'POST',//请求方式                            data: function (validator) {                                return {                                    goodsname: $("#goodsname").val(),                                    goodsid: g_id                                };                            }                        }                    }                }            }        }).on('success.form.bv', function (e) {            // Prevent form submission            e.preventDefault();            var param = turnArrayToJson($('form').serializeArray());            if (g_id) {                param.goodsid = g_id            }            $.post(urlPrefix + "/goods/edit", param, function (result) {                parent.toSave(result)            })        });    }</script>