<!DOCTYPE html><html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"><head th:include="head::head(${title})"></head><link th:href="@{/assets/css/select/bootstrap-select.min.css}" rel="stylesheet" media="screen"><script th:src="@{/assets/js/select/bootstrap-select.js}"></script><script th:src="@{/assets/js/select/defaults-zh_CN.js}"></script><body><div th:replace="navbar::navbar"></div><div class="main-container" id="main-container">    <div class="breadcrumbs" id="breadcrumbs">        <ul class="breadcrumb">            <li>                <i class="icon-home home-icon"></i>                首页            </li>            <li>                <i class="icon-table home-icon"></i>                物料            </li>        </ul>    </div>    <div style="margin-top: 4px;margin-bottom: 4px">        <div class="col-sm-3">            <button class="btn btn-sm btn-primary" onclick="toAdd()">                <i class="icon-plus align-top bigger-125"></i>                添加物料            </button>            <button class="btn btn-sm btn-danger" onclick="doDel()">                <i class="icon-trash align-top bigger-125"></i>                删除物料            </button>        </div>    </div>    <div class="col-sm-8">        <div class="col-sm-3">            <div class="input-group">                <span class="input-group-addon">物料名称:</span>                <input id="goodsname" name="goodsname" type="text" class="form-control">            </div>        </div>        <div class="col-sm-3">            <div class="input-group">                <span class="input-group-addon">物料类型名称:</span>                <!--<input id="goodstypename" name="goodstypename" type="text" class="form-control">-->                <select id="goodstypeid" name="goodstypeid" class="form-control" >                </select>            </div>        </div>        <div class="col-sm-4">            <button class="btn btn-sm btn-success" onclick="searchTable()">                <i class="icon-search align-top bigger-125"></i>                查询            </button>            <button class="btn btn-sm btn-warning" onclick="rest()">                <i class="icon-undo align-top bigger-125"></i>                重置            </button>        </div>    </div>    <div class="table-responsive" style="width:100%">        <table id="myTable" style="width:100%" class="table table-striped table-bordered table-hover">            <thead>            <tr>                <th class="center" style="width: 2%"></th>                <th class="center" style="width: 2%">                    <label>                        <input id="CK" type="checkbox" class="ace"/>                        <span class="lbl"></span>                    </label>                </th>                <th style="width: 15%">物料名称</th>                <th style="width: 15%">物料编码</th>                <th style="width: 15%">物料类型</th>                <th style="width: 15%">规格</th>                <th style="width: 15%">计量单位</th>                <!--<th style="width: 10%">创建人</th>-->                <!--<th style="width: 10%">创建时间</th>-->                <!--<th style="width: 10%">备注</th>-->                <!--<th style="width: 20%">集团</th>-->                <!--<th style="width: 10%">企业</th>-->                <!--<th style="width: 10%">粮库</th>-->                <th style="width: 10%">操作</th>            </tr>            </thead>        </table>    </div>    <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">        <i class="icon-double-angle-up icon-only bigger-110"></i>    </a></div></body></html><script th:inline="javascript">    var urlPrefix = "/graindepot-bussiness";    //var urlPrefix = "";    var theTable;    // var g_item = [[${item}]];    // $(function () {        //初始化form验证        // initForm();        //1初始化物料类型下拉框（根据当前粮库查询）        // initGoodsTypeID();    // });    function selectOnchang(o) {        //获取全部打钩的check的值        //$('#myTable th input:checkbox:checked')        console.log($('#myTable').bootstrapTable("getChecked"))    }    $(document).ready(function () {        query();        initGoodsTypeID();    });    // var g_item = [[${item}]];    function initGoodsTypeID() {        $("#goodstypeid").bootstrapSelect({            url: '/graindepot-bussiness/selector/goodstypeList',            type: 'GET',            valueField: 'goodstypeid',            textField: 'goodstypename',            // defaultValue: g_item.goodstypeid        })    }    //查询列表    function query(param) {        theTable = $('#myTable').bootstrapTable({            //数据来源（包括处理分页，排序，过滤） ，即url，action，接口，等等            ajax: {                url: urlPrefix + "/goods/list/page",                data: param,                type: "GET"            },            //sScrollY: 510,//表格高度            columns: [                {title: "物料名称", data: "goodsname"},                {title: "物料编码", data: "goodscode"},                {title: "物料类型", data: "goodstypename"},                {title: "规格", data: "goodsspec"},                {title: "计量单位", data: "measunit"},                // {title: "创建人", data: "createuserid"},                // {title: "创建时间", data: "updatetime"},                // {title: "备注", data: "description"},                // {title: "集团", data: "groupid"},                // {title: "企业", data: "companyid"},                // {title: "粮库", data: "graindepotid"},                {                    data: "goodsid",                    render: function (data, type, row) {                        return '<div class="visible-md visible-lg hidden-sm hidden-xs action-buttons">' +                            '<a class="green" href="javascript:toEdit(' + data + ')"' +                            ' title="编辑" ' +                            '>' +                            '<i class="icon-pencil bigger-130"></i>' +                            '</a>' +                            '<a class="blue" href="javascript:toDetail(' + data + ')"' +                            'title="详情"' +                            '>' +                            '<i class="icon-eye-open bigger-130"></i>' +                            '</a>' +                            '</div>';                    }                }            ]        });    }    function searchTable() {        theTable.destroy();        query(getParam());    }    function getParam() {        var param = {};        param.goodsname = $("#goodsname").val();        param.goodstypeid = $("#goodstypeid").val();        return param    }    function rest() {        $("input").val("");        $("select").val("");        //触发change事件        $("select").trigger("change");        searchTable();        //$("#city").find("option[value = '"+"']").attr("selected","selected");//jq改变select的选中值    }    function doDel() {        console.log($('#myTable').bootstrapTable("getChecked"));          var checkedList = $('#myTable').bootstrapTable("getChecked");        if (checkedList.length == 0) {            $.bootstrapBox.alert.init({message: "请选择需要删除的行"});            return        }        $.bootstrapBox.confirm.init({            message: "确认删除？",            callback: function (result) {                if (result) {                    //删除用户                    var ids = checkedList.map(function (curr) {                        return curr.goodsid                    });                    $.post(urlPrefix + "/goods/del", {ids: ids.join(",")}, function (result) {                        $.bootstrapBox.alert.init({                            message: result.message                        });                        $("#myTable").bootstrapTable("reload");                    })                }            }        });    }    function toAdd() {        $.bootstrapBox.dialog.init({            title: "新增物料",            url: urlPrefix + "/page/goods/edit",            width: $(window).width() * 0.6,            height: $(window).height() * 0.9        })    }    function toEdit(id) {        $.bootstrapBox.dialog.init({            title: "修改物料",            url: urlPrefix + "/page/goods/edit?id=" + id,            width: $(window).width() * 0.6,            height: $(window).height() * 0.9        })    }    function toDetail(id) {        $.bootstrapBox.dialog.init({            title: "物料详情",            url: urlPrefix + "/page/goods/detail/" + id,            width: $(window).width() * 0.8,            height: $(window).height() * 0.9        })    }    function toSave(result) {        $.bootstrapBox.dialog.close();        $.bootstrapBox.alert.init({            message: result.message        });        $("#myTable").bootstrapTable("reload")    }</script>